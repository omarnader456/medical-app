<h1>Select a Patient</h1>
<ul>
    <% assignments.forEach(a => { %>
        <li>
            <%= a.patient.name %> 
            <button onclick="selectPatient('<%= a.patient._id %>')">Select</button>
        </li>
    <% }) %>
</ul>

<script>
async function selectPatient(pid) {
    const csrf = document.querySelector('meta[name="csrf-token"]').content;

    const res = await fetch('/set-patient', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'CSRF-Token': csrf 
        },
        body: JSON.stringify({ patientId: pid }),
        credentials: 'include'
    });

    if (res.ok) {
        window.location.href = '/doctor/dashboard';
    } else {
        const json = await res.json();
        alert(json.message);
    }
}
</script>